<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <title>Lesson Points</title>

</head>
<body dir="rtl">
<h1>ğŸ“š ××¢×¨×›×ª × ×™×§×•×“ ×œ×ª×œ××™×“×™×</h1>

<!-- ×˜×•×¤×¡ ×™×¦×™×¨×ª ×ª×œ××™×“ -->
<h2>ğŸ§‘ ×™×¦×™×¨×ª ×ª×œ××™×“ ×—×“×©</h2>
<form id="studentForm">
    <label>×©× ×¤×¨×˜×™: <input type="text" name="firstName" required></label><br>
    <label>×©× ××©×¤×—×”: <input type="text" name="lastName" required></label><br>
    <label>×˜×œ×¤×•×Ÿ ×ª×œ××™×“: <input type="text" name="phone" required></label><br>
    <label>×˜×œ×¤×•×Ÿ ×”×•×¨×”: <input type="text" name="parentPhone" required></label><br>
    <label>×ª×¢×•×“×ª ×–×”×•×ª: <input type="text" name="id" required></label><br>
    <button type="submit">âœ… ×¦×•×¨ ×ª×œ××™×“</button>
</form>

<hr>

<!-- ×›×¤×ª×•×¨×™ ×¤×¢×•×œ×•×ª -->
<h2>ğŸ¯ ×¢×“×›×•×Ÿ × ×§×•×“×•×ª</h2>
<label>×ª×¢×•×“×ª ×–×”×•×ª ×©×œ ×ª×œ××™×“: <input type="text" id="studentId" /></label><br><br>

<button onclick="updatePoints('onTime')">ğŸ• ×”×’×¢×” ×‘×–××Ÿ</button>
<button onclick="updatePoints('listen')">ğŸ‘‚ ×”×§×©×‘×”</button>
<button onclick="updatePoints('active')">ğŸ™‹â€â™‚ï¸ ×”×©×ª×ª×¤×•×ª ××§×˜×™×‘×™×ª</button>
<button onclick="updatePoints('late')">â° ××™×—×•×¨</button>
<button onclick="updatePoints('sleep')">ğŸ˜´ ×©×™× ×” ×‘×©×™×¢×•×¨</button>
<button onclick="updatePoints('disturb')">ğŸ˜¡ ×”×¤×¨×¢×”</button>

<p id="result"></p>

<script>
    document.getElementById('studentForm').addEventListener('submit', async function (e) {
        e.preventDefault();

        const form = e.target;
        const student = {
            firstName: form.firstName.value,
            lastName: form.lastName.value,
            phone: form.phone.value,
            parentPhone: form.parentPhone.value,
            id: form.id.value,
            points: 0
        };

        const res = await fetch('/api/student', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(student)
        });

        const text = await res.text();
        document.getElementById('result').innerText = text;
        form.reset();
    });

    async function updatePoints(action) {
        const id = document.getElementById('studentId').value;
        if (!id) {
            alert("×™×© ×œ×”×–×™×Ÿ ×ª×¢×•×“×ª ×–×”×•×ª");
            return;
        }

        const res = await fetch(`/api/student/${id}/points?action=${action}`, {
            method: 'POST'
        });

        const text = await res.text();
        document.getElementById('result').innerText = text;
    }
</script>
